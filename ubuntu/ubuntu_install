# https://www.youtube.com/watch?v=Mc70SjV72ck
sudo apt install net-tools
touch .hushlogin
sudo apt update
sudo apt upgrade -y
sudo apt install git python3-dev libffi-dev gcc libssl-dev libdbus-glib-1-dev python3-venv
python3 -m venv ~/kolla
source ~/kolla/bin/activate
pip install -U pip
pip install docker pkgconfig dbus-python
pip install git+https://opendev.org/openstack/kolla-ansible@master
sudo mkdir -p /etc/kolla
sudo chown $USER:$USER /etc/kolla
cp -r ~/kolla/share/kolla-ansible/etc_examples/kolla/* /etc/kolla/
ls kolla/share/kolla-ansible/ansible/inventory/
cp kolla/share/kolla-ansible/ansible/inventory/all-in-one .
kolla-ansible install-deps
kolla-genpwd
sudo vim /etc/kolla/globals.yml
kolla-ansible bootstrap-servers -i all-in-one
kolla-ansible prechecks -i all-in-one
kolla-ansible deploy -i all-in-one
pip install python-openstackclient -c https://releases.openstack.org/constraints/upper/master
kolla-ansible post-deploy -i all-in-one
mkdir -p ~/.config/openstack
cp /etc/kolla/clouds.yaml ~/.config/openstack/
vim .bashrc
	#export OS_CLOUD=kolla-admin
	#source ~/kolla/bin/activate
sudo usermod -aG docker $USER

# Verification
openstack service list
openstack compute service list
openstack network agent list
openstack volume service list
docker ps
grep keystone_admin_password /etc/kolla/passwords.yml

#Verification
grep keystone_admin_password /etc/kolla/passwords.yml
cp kolla/share/kolla-ansible/init-runonce .
vim init-runonce
./init-runonce
openstack --os-cloud=kolla-admin server create     --image cirros     --flavor m1.tiny     --key-name mykey     --network demo-net     demo1
openstack server list
openstack network list --external
openstack floating ip create public1
openstack server add floating ip demo1 192.168.2.107
openstack server show demo1 -c addresses
ssh cirros@192.168.2.107
#Terraform Install
sudo apt-get update && sudo apt-get install -y gnupg software-properties-common
wget -O- https://apt.releases.hashicorp.com/gpg | gpg --dearmor | sudo tee /usr/share/keyrings/hashicorp-archive-keyring.gpg > /dev/null
gpg --no-default-keyring --keyring /usr/share/keyrings/hashicorp-archive-keyring.gpg --fingerprint
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/hashicorp-archive-keyring.gpg] https://apt.releases.hashicorp.com $(grep -oP '(?<=UBUNTU_CODENAME=).*' /etc/os-release || lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/hashicorp.list
sudo apt update
sudo apt-get install terraform
pip install python-designateclient
openstack zone list
openstack recordset list rdulinux.com.
openstack recordset list 2.168.192.in-addr.arpa.
